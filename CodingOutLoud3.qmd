---
title: "CodingOutLoud3"
author: "Gwen Peterson"
format: html
---
Getting stuff
```{r}
library(tidyverse)
library(ggplot2)
library(ggforce)
```


```{r}
ids <- factor(c("1.1", "2.1", "1.2", "2.2", "1.3", "2.3"))
values <- data.frame(
id = ids,
value = c(3, 3.1, 3.1, 3.2, 3.15, 3.5)
)
positions <- data.frame(
id = rep(ids, each = 4),
x_poly = c(2, 1, 1.1, 2.2, 1, 0, 0.3, 1.1, 2.2, 1.1, 1.2, 2.5, 1.1, 0.3,
0.5, 1.2, 2.5, 1.2, 1.3, 2.7, 1.2, 0.5, 0.6, 1.3),
y_poly = c(-0.5, 0, 1, 0.5, 0, 0.5, 1.5, 1, 0.5, 1, 2.1, 1.7, 1, 1.5,
2.2, 2.1, 1.7, 2.1, 3.2, 2.8, 2.1, 2.2, 3.3, 3.2)
)
# Currently we need to manually merge the two together
datapoly <- merge(values, positions, by = c("id"))
#ggplot(datapoly, aes(x = x, y = y)) +
#geom_polygon(aes(fill = values, group = id))
#dataset w/ 9 rows (circles) and 3 variables (x & y coordinates of center, radius)
circles <- data_frame(
id = 1:9,
x1 = rep(1, 9),
x2 = seq(-0.2, 0.2, length.out = 9),
y = seq(-1, 1, length.out = 9),
x_center = sin(y)/4,
x_m1 = x_center - 0.25,
x_m2 = x_center - 0.5,
x_m3 = x_center - 0.75,
x_p1 = x_center + 0.25,
x_p2 = x_center + 0.5,
x_p3 = x_center + 0.75,
r1 = 0.05,
r2 = (-(y^2) + 2) / 20
) |>
mutate(
x_m1 = if_else(y == max(y) | y == min(y), x_m1 + 0.1, x_m1),
x_p1 = if_else(y == max(y) | y == min(y), x_p1 - 0.1, x_p1),
x_m2 = if_else(y == min(y), x_m1 - 0.2, x_m1 - 0.25),
r_m2 = (y + 2) / 30,
y_m2 = if_else(y == min(y), y + 0.125, y),
x_p2 = if_else(y == min(y), x_p1 + 0.2, x_p1 + 0.25),
r_p2 = (y + 2) / 30,
y_p2 = if_else(y == min(y), y + 0.125, y),
x_m3 = x_m2 - (0.3 - y^2 / 8),
r_m3 = (2 - y) / 30,
y_m3 = y,
x_p3 = x_p2 + (0.3 - y^2 / 8),
r_p3 = (2 - y) / 30,
y_p3 = y
)
ggplot() +
#This is the yellow circle
geom_circle(aes(x0 = 0.1, y0 = 0.05, r = 1.25), data = circles, fill = "#FFC700", color = "#FFC700") +
#these are the black circles
geom_circle(aes(x0 = x_center, y0 = y, r = r2), data = circles, fill = "black") +
geom_circle(aes(x0 = x_m1, y0 = y, r = r1), data = circles, fill = "black") +
geom_circle(aes(x0 = x_p1, y0 = y, r = r1), data = circles, fill = "black") +
geom_circle(aes(x0 = x_m2, y0 = y_m2, r = r_m2), data = circles, fill = "black") +
geom_circle(aes(x0 = x_p2, y0 = y_p2, r = r_p2), data = circles, fill = "black") +
geom_circle(aes(x0 = x_m3, y0 = y_m3, r = r_m3), data = circles, fill = "black") +
geom_circle(aes(x0 = x_p3, y0 = y_p3, r = r_p3), data = circles, fill = "black") +
coord_fixed() +
geom_polygon(data = datapoly, aes(fill = value, x = x_poly, y = y_poly))
#this makes the background
theme_void() +
theme(panel.background = element_rect(fill = "#FFDE00", color = "#FFDE00"))
```

edited